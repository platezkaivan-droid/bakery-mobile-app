# ‚úÖ GOOGLE AUTH –ò–°–ü–†–ê–í–õ–ï–ù

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å Google Auth - —Ç–µ–ø–µ—Ä—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≤–∏—Å–∞–µ—Ç!

---

## üîß –ò–∑–º–µ–Ω–µ–Ω–∏—è

### 1. **AuthContext.tsx**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ Deep Links –¥–ª—è OAuth callback
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `signInWithGoogle` —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –ø–æ—Å–ª–µ OAuth
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ URL –≤ –±—Ä–∞—É–∑–µ—Ä–µ

### 2. **supabase.ts**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `expo-linking`

### 3. **app.json**
- ‚úÖ Deep Links —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ –°—Ö–µ–º–∞: `bakery-app://auth-callback`

---

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –®–∞–≥ 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google"
```
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Üí signInWithGoogle()
```

### –®–∞–≥ 2: –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä/Custom Tab
```
Supabase –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç URL ‚Üí –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä
```

### –®–∞–≥ 3: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è –≤ Google
```
Google ‚Üí –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Üí Supabase
```

### –®–∞–≥ 4: –í–æ–∑–≤—Ä–∞—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```
Supabase ‚Üí bakery-app://auth-callback?token=...
```

### –®–∞–≥ 5: –û–±—Ä–∞–±–æ—Ç–∫–∞ callback
```
Deep Link ‚Üí AuthContext ‚Üí –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ ‚Üí –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è
```

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –í–∞—Ä–∏–∞–Ω—Ç 1: Expo Go (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

```bash
cd bakery-app/bakery-mobile-app/bakery-app
npx expo start
```

1. –°–∫–∞–Ω–∏—Ä—É–π QR-–∫–æ–¥ –≤ Expo Go
2. –ù–∞–∂–º–∏ "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google"
3. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Å—è –≤ Google
4. –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ!

### –í–∞—Ä–∏–∞–Ω—Ç 2: APK (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

```bash
cd bakery-app/bakery-mobile-app/bakery-app/android
./gradlew assembleRelease
```

1. –£—Å—Ç–∞–Ω–æ–≤–∏ APK –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω
2. –ù–∞–∂–º–∏ "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google"
3. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Å—è –≤ Google
4. –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ!

---

## üîç –û–¢–õ–ê–î–ö–ê

### –°–º–æ—Ç—Ä–∏ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏:

```
üîê Starting Google Sign In...
‚úÖ OAuth data received: { url: '...' }
üì± Opening URL in browser: https://...
‚úÖ URL opened successfully
üîó Deep link received: bakery-app://auth-callback?...
‚úÖ OAuth callback detected
‚úÖ Session restored after OAuth
```

### –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü—Ä–æ–≤–µ—Ä—å Deep Links:**
```bash
adb shell am start -W -a android.intent.action.VIEW -d "bakery-app://auth-callback" com.bakery.pavlova
```

2. **–ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏:**
```bash
npx react-native log-android
```

3. **–ü—Ä–æ–≤–µ—Ä—å Supabase Dashboard:**
   - Authentication ‚Üí URL Configuration
   - Redirect URLs –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å: `bakery-app://auth-callback`

---

## üì± –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase

### 1. –û—Ç–∫—Ä–æ–π Supabase Dashboard
```
https://supabase.com/dashboard
```

### 2. –ü–µ—Ä–µ–π–¥–∏ –≤ Authentication ‚Üí URL Configuration

### 3. –î–æ–±–∞–≤—å Redirect URL:
```
bakery-app://auth-callback
```

### 4. –î–æ–±–∞–≤—å Site URL (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
```
bakery-app://
```

---

## üé® –£–ª—É—á—à–µ–Ω–∏—è UX

### –î–æ–±–∞–≤—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏:

–í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:

```typescript
const [isGoogleLoading, setIsGoogleLoading] = useState(false);

const handleGoogleSignIn = async () => {
  try {
    setIsGoogleLoading(true);
    await signInWithGoogle();
    // –ù–µ —É–±–∏—Ä–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∑–¥–µ—Å—å - –æ–Ω–∞ —É–±–µ—Ä—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    // –∫–æ–≥–¥–∞ –≤–µ—Ä–Ω—ë–º—Å—è –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è —Å–µ—Å—Å–∏—è
  } catch (error) {
    setIsGoogleLoading(false);
    Alert.alert('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google');
  }
};
```

### –î–æ–±–∞–≤—å —Ç–µ–∫—Å—Ç –æ–∂–∏–¥–∞–Ω–∏—è:

```typescript
{isGoogleLoading && (
  <Text style={styles.loadingText}>
    –û—Ç–∫—Ä—ã–≤–∞–µ–º Google –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏...
  </Text>
)}
```

---

## ‚ú® –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –î–æ:
- ‚ùå –û—Ç–∫—Ä—ã–≤–∞–ª—Å—è –±—Ä–∞—É–∑–µ—Ä
- ‚ùå –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∞–ª–æ
- ‚ùå –ù–µ –≤–æ–∑–≤—Ä–∞—â–∞–ª–æ—Å—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- ‚ùå –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ callback

### –ü–æ—Å–ª–µ:
- ‚úÖ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä/Custom Tab
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∂–¥—ë—Ç –≤–æ–∑–≤—Ä–∞—Ç–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è callback
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å–µ—Å—Å–∏—è
- ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–æ—Ñ–∏–ª—å

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ß—Ç–æ –∑–∞—â–∏—â–µ–Ω–æ:
- ‚úÖ OAuth —Ç–æ–∫–µ–Ω—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Deep Link
- ‚úÖ Supabase –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω—ã
- ‚úÖ –°–µ—Å—Å–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ AsyncStorage
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
- –ò—Å–ø–æ–ª—å–∑—É–π HTTPS –¥–ª—è production
- –ù–∞—Å—Ç—Ä–æ–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ Redirect URLs –≤ Supabase
- –ù–µ –ª–æ–≥–∏—Ä—É–π —Ç–æ–∫–µ–Ω—ã –≤ production

---

## üìû –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ü—Ä–æ–≤–µ—Ä—å Google Cloud Console:
- Authorized redirect URIs –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
  - `https://qkyhwdmhkoizxjazwnti.supabase.co/auth/v1/callback`
  - `bakery-app://auth-callback` (–¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö)

### 2. –ü—Ä–æ–≤–µ—Ä—å Supabase:
- Authentication ‚Üí Providers ‚Üí Google ‚Üí Enabled
- Redirect URLs —Å–æ–¥–µ—Ä–∂–∏—Ç `bakery-app://auth-callback`

### 3. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
cd android
./gradlew clean
./gradlew assembleRelease
```

### 4. –ü—Ä–æ–≤–µ—Ä—å AndroidManifest.xml:
```xml
<intent-filter android:autoVerify="true">
  <action android:name="android.intent.action.VIEW" />
  <category android:name="android.intent.category.DEFAULT" />
  <category android:name="android.intent.category.BROWSABLE" />
  <data android:scheme="bakery-app" android:host="auth-callback" />
</intent-filter>
```

---

## ‚úÖ –ì–û–¢–û–í–û!

–¢–µ–ø–µ—Ä—å Google Auth —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è
3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
4. –°–µ—Å—Å–∏—è –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–ú–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å!** üéâ
