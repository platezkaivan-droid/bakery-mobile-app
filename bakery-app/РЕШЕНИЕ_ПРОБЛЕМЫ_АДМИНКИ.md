# üîß –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ê–î–ú–ò–ù–ö–ò –ß–ê–¢–ê

## üö® –ü—Ä–æ–±–ª–µ–º–∞

–ê–¥–º–∏–Ω–∫–∞ –Ω–µ –≤–∏–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π" –∏ 0 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

## üîç –ü—Ä–∏—á–∏–Ω–∞

Row Level Security (RLS) –≤ Supabase –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ç–∞–∫, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è. –ê–¥–º–∏–Ω–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–∞–Ω–æ–Ω–∏–º–Ω–æ), –ø–æ—ç—Ç–æ–º—É –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º.

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï (–≤—ã–±–µ—Ä–∏ –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç)

### üü¢ –í–ê–†–ò–ê–ù–¢ 1: –†–∞–∑—Ä–µ—à–∏—Ç—å –∞–Ω–æ–Ω–∏–º–Ω—ã–π –¥–æ—Å—Ç—É–ø (–ë–´–°–¢–†–û)

**–î–ª—è –∫–æ–≥–æ:** –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∞–¥–º–∏–Ω–∫—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–®–∞–≥–∏:**

1. –û—Ç–∫—Ä–æ–π **Supabase Dashboard**
2. –ü–µ—Ä–µ–π–¥–∏ –≤ **SQL Editor**
3. –°–∫–æ–ø–∏—Ä—É–π –∏ –≤—ã–ø–æ–ª–Ω–∏ —ç—Ç–æ—Ç SQL:

```sql
-- –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –ø–æ–ª–∏—Ç–∏–∫—É
DROP POLICY IF EXISTS "User sees their own messages" ON support_messages;

-- –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é: –≤—Å–µ –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è
CREATE POLICY "Anyone can read messages" 
ON support_messages 
FOR SELECT 
USING (true);

-- –†–∞–∑—Ä–µ—à–∞–µ–º –≤—Å—Ç–∞–≤–∫—É –æ—Ç –∏–º–µ–Ω–∏ –¥—Ä—É–≥–∏—Ö (–¥–ª—è –∞–¥–º–∏–Ω–∞)
DROP POLICY IF EXISTS "User can insert messages" ON support_messages;

CREATE POLICY "User can insert own messages" 
ON support_messages 
FOR INSERT 
WITH CHECK (auth.uid() = user_id OR auth.uid() IS NULL);
```

4. –ù–∞–∂–º–∏ **Run**
5. –û–±–Ω–æ–≤–∏ –∞–¥–º–∏–Ω–∫—É (F5)

**‚úÖ –ì–æ—Ç–æ–≤–æ!** –ê–¥–º–∏–Ω–∫–∞ —Ç–µ–ø–µ—Ä—å –≤–∏–¥–∏—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è.

‚ö†Ô∏è **–ú–∏–Ω—É—Å:** –õ—é–±–æ–π –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

---

### üü° –í–ê–†–ò–ê–ù–¢ 2: –°–æ–∑–¥–∞—Ç—å —Ä–æ–ª—å –∞–¥–º–∏–Ω–∞ (–ë–ï–ó–û–ü–ê–°–ù–û)

**–î–ª—è –∫–æ–≥–æ:** –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–®–∞–≥–∏:**

1. –û—Ç–∫—Ä–æ–π **Supabase Dashboard** ‚Üí **SQL Editor**
2. –í—ã–ø–æ–ª–Ω–∏ —ç—Ç–æ—Ç SQL:

```sql
-- 1. –°–æ–∑–¥–∞—ë–º —Ç–∞–±–ª–∏—Ü—É —Ä–æ–ª–µ–π
CREATE TABLE IF NOT EXISTS user_roles (
  user_id UUID REFERENCES auth.users(id) PRIMARY KEY,
  is_admin BOOLEAN DEFAULT false,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now())
);

-- 2. –í–∫–ª—é—á–∞–µ–º RLS
ALTER TABLE user_roles ENABLE ROW LEVEL SECURITY;

-- 3. –í—Å–µ –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å —Ä–æ–ª–∏
CREATE POLICY "Anyone can read roles" 
ON user_roles 
FOR SELECT 
USING (true);

-- 4. –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è support_messages
DROP POLICY IF EXISTS "User sees their own messages" ON support_messages;
DROP POLICY IF EXISTS "Anyone can read messages" ON support_messages;

-- –ê–¥–º–∏–Ω –≤–∏–¥–∏—Ç –≤—Å–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏
CREATE POLICY "Admin or user sees messages" 
ON support_messages 
FOR SELECT 
USING (
  auth.uid() = user_id 
  OR 
  EXISTS (
    SELECT 1 FROM user_roles 
    WHERE user_id = auth.uid() AND is_admin = true
  )
);

-- –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ª—é–±–æ–º—É
DROP POLICY IF EXISTS "User can insert messages" ON support_messages;

CREATE POLICY "User or admin can insert messages" 
ON support_messages 
FOR INSERT 
WITH CHECK (
  auth.uid() = user_id 
  OR 
  EXISTS (
    SELECT 1 FROM user_roles 
    WHERE user_id = auth.uid() AND is_admin = true
  )
);
```

3. **–ù–∞–π–¥–∏ —Å–≤–æ–π User ID:**
   - Supabase Dashboard ‚Üí **Authentication** ‚Üí **Users**
   - –°–∫–æ–ø–∏—Ä—É–π —Å–≤–æ–π UUID

4. **–°–¥–µ–ª–∞–π —Å–µ–±—è –∞–¥–º–∏–Ω–æ–º:**
```sql
INSERT INTO user_roles (user_id, is_admin)
VALUES ('–¢–í–û–ô_USER_ID_–ó–î–ï–°–¨', true);
```

5. **–û–±–Ω–æ–≤–∏ –∞–¥–º–∏–Ω–∫—É** –∏ –≤–æ–π–¥–∏ –ø–æ–¥ —Å–≤–æ–∏–º –∞–∫–∫–∞—É–Ω—Ç–æ–º

**‚úÖ –ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã –≤–∏–¥—è—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è.

---

### üî¥ –í–ê–†–ò–ê–ù–¢ 3: –û—Ç–∫–ª—é—á–∏—Ç—å RLS (–¢–û–õ–¨–ö–û –î–õ–Ø –†–ê–ó–†–ê–ë–û–¢–ö–ò!)

**–î–ª—è –∫–æ–≥–æ:** –¢–æ–ª—å–∫–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

‚ö†Ô∏è **–í–ù–ò–ú–ê–ù–ò–ï!** –≠—Ç–æ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ! –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!

```sql
ALTER TABLE support_messages DISABLE ROW LEVEL SECURITY;
```

---

## üß™ –ü–†–û–í–ï–†–ö–ê

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL –ø—Ä–æ–≤–µ—Ä—å:

### 1. –ü—Ä–æ–≤–µ—Ä—å –ø–æ–ª–∏—Ç–∏–∫–∏:
```sql
SELECT * FROM pg_policies WHERE tablename = 'support_messages';
```

### 2. –ü—Ä–æ–≤–µ—Ä—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π:
```sql
SELECT COUNT(*) FROM support_messages;
```

### 3. –ü–æ—Å–º–æ—Ç—Ä–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
```sql
SELECT * FROM support_messages ORDER BY created_at DESC LIMIT 10;
```

---

## üîç –û–¢–õ–ê–î–ö–ê –ê–î–ú–ò–ù–ö–ò

–ê–¥–º–∏–Ω–∫–∞ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:

1. –û—Ç–∫—Ä–æ–π –∞–¥–º–∏–Ω–∫—É
2. –ù–∞–∂–º–∏ **F12** (–æ—Ç–∫—Ä—ã—Ç—å –∫–æ–Ω—Å–æ–ª—å)
3. –°–º–æ—Ç—Ä–∏ –ª–æ–≥–∏:
   - üîå –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
   - üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
   - ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
   - ‚ùå –û—à–∏–±–∫–∏

**–ß—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å:**
- `‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ!` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- `‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π: X` - —Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞–≥—Ä—É–∂–µ–Ω–æ
- `‚ùå –û—à–∏–±–∫–∞:` - –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

---

## üìù –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –û—Ç–ø—Ä–∞–≤—å —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:

1. –û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ/—ç–º—É–ª—è—Ç–æ—Ä–µ
2. –ü–µ—Ä–µ–π–¥–∏ –≤ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞**
3. –û—Ç–ø—Ä–∞–≤—å —Å–æ–æ–±—â–µ–Ω–∏–µ: "–¢–µ—Å—Ç"
4. –û–±–Ω–æ–≤–∏ –∞–¥–º–∏–Ω–∫—É (F5)
5. –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ!

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π **–í–∞—Ä–∏–∞–Ω—Ç 1** (–∞–Ω–æ–Ω–∏–º–Ω—ã–π –¥–æ—Å—Ç—É–ø)

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π **–í–∞—Ä–∏–∞–Ω—Ç 2** (—Ä–æ–ª—å –∞–¥–º–∏–Ω–∞)

### –ù–∏–∫–æ–≥–¥–∞:
‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π **–í–∞—Ä–∏–∞–Ω—Ç 3** (–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ RLS) –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!

---

## üÜò –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ü—Ä–æ–≤–µ—Ä—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:
- –û—Ç–∫—Ä–æ–π –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
- –°–º–æ—Ç—Ä–∏ –ª–æ–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä—å URL –∏ –∫–ª—é—á Supabase

### 2. –ü—Ä–æ–≤–µ—Ä—å —Ç–∞–±–ª–∏—Ü—É:
```sql
-- –ï—Å—Ç—å –ª–∏ —Ç–∞–±–ª–∏—Ü–∞?
SELECT * FROM information_schema.tables 
WHERE table_name = 'support_messages';

-- –ï—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ?
SELECT * FROM support_messages LIMIT 5;
```

### 3. –ü—Ä–æ–≤–µ—Ä—å RLS:
```sql
-- –í–∫–ª—é—á–µ–Ω –ª–∏ RLS?
SELECT tablename, rowsecurity 
FROM pg_tables 
WHERE tablename = 'support_messages';
```

### 4. –û—Ç–ø—Ä–∞–≤—å —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:
- –ò–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤—å "–¢–µ—Å—Ç"
- –ü—Ä–æ–≤–µ—Ä—å –≤ Supabase Dashboard ‚Üí Table Editor
- –í–∏–¥–∏—à—å —Å–æ–æ–±—â–µ–Ω–∏–µ? –ó–Ω–∞—á–∏—Ç –ø—Ä–æ–±–ª–µ–º–∞ –≤ –ø–æ–ª–∏—Ç–∏–∫–∞—Ö

---

## ‚ú® –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–ê–¥–º–∏–Ω–∫–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å:
- ‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–ª–µ–≤–∞
- ‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è —Å–ø—Ä–∞–≤–∞

**–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –∞–¥–º–∏–Ω–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç!** üéâ
