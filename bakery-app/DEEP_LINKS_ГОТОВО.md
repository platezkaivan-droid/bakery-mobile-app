# ‚úÖ DEEP LINKS –ù–ê–°–¢–†–û–ï–ù–´!

## –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:

### 1. ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Å—Ö–µ–º–∞ –≤ app.json
- –°—Ö–µ–º–∞: `bakery-app://`
- Host: `auth-callback`
- –î–æ–±–∞–≤–ª–µ–Ω—ã `intentFilters` –¥–ª—è Android

### 2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ Deep Links –≤ app/_layout.tsx
- –°–ª—É—à–∞–µ—Ç —Å—Å—ã–ª–∫–∏ –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Ñ–æ–Ω–µ
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å—Å—ã–ª–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–µ—Å—Å–∏—é
- –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

### 3. ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω AuthContext
- –î–æ–±–∞–≤–ª–µ–Ω `emailRedirectTo: 'bakery-app://auth-callback'`
- –¢–µ–ø–µ—Ä—å –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è email –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ!

### 4. ‚úÖ –°–æ–∑–¥–∞–Ω –∫—Ä–∞—Å–∏–≤—ã–π HTML —à–∞–±–ª–æ–Ω –¥–ª—è email
- –§–∞–π–ª: `EMAIL_TEMPLATE.html`
- –ì–æ—Ç–æ–≤ –∫ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—é –≤ Supabase

---

## üìã –ß–¢–û –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨ –í SUPABASE

### –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Redirect URLs

1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard
2. **Authentication** ‚Üí **URL Configuration**
3. –í **Redirect URLs** –¥–æ–±–∞–≤—å—Ç–µ:
   ```
   bakery-app://auth-callback
   exp://localhost:8081
   ```
4. –ù–∞–∂–º–∏—Ç–µ **Save**

### –®–∞–≥ 2: –í–∫–ª—é—á–∏—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ Email

1. **Authentication** ‚Üí **Providers** ‚Üí **Email**
2. –í–∫–ª—é—á–∏—Ç–µ **"Confirm email"** ‚úÖ
3. –ù–∞–∂–º–∏—Ç–µ **Save**

### –®–∞–≥ 3: –û–±–Ω–æ–≤–∏—Ç–µ Email —à–∞–±–ª–æ–Ω

1. **Authentication** ‚Üí **Email Templates**
2. –í—ã–±–µ—Ä–∏—Ç–µ **"Confirm signup"**
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `EMAIL_TEMPLATE.html`
4. –í—Å—Ç–∞–≤—å—Ç–µ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä
5. –ù–∞–∂–º–∏—Ç–µ **Save**

---

## üîß –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `app.json` –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å:

```bash
# –û—á–∏—Å—Ç–∏—Ç–µ –∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ
npx expo prebuild --clean

# –°–æ–±–µ—Ä–∏—Ç–µ APK
cd android
./gradlew assembleRelease
```

---

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –¢–µ—Å—Ç 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –ù–∞–∂–º–∏—Ç–µ "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è"
3. –í–≤–µ–¥–∏—Ç–µ email –∏ –ø–∞—Ä–æ–ª—å
4. –ù–∞–∂–º–∏—Ç–µ "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è"
5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É** ‚úâÔ∏è

### –¢–µ—Å—Ç 2: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ Email

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∏—Å—å–º–æ "–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ Email - –ë—É–ª–æ—á–∫–∏ –ü–∞–≤–ª–æ–≤–∞"
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å Email"**
3. –¢–µ–ª–µ—Ñ–æ–Ω —Å–ø—Ä–æ—Å–∏—Ç: **"–û—Ç–∫—Ä—ã—Ç—å –≤ –ë—É–ª–æ—á–∫–∏ –ü–∞–≤–ª–æ–≤–∞?"**
4. –ù–∞–∂–º–∏—Ç–µ **"–û—Ç–∫—Ä—ã—Ç—å"**
5. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –∏ –≤—ã –±—É–¥–µ—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã! ‚úÖ

---

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –ù–∞–∂–∏–º–∞–µ—Ç "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å Email" –≤ –ø–∏—Å—å–º–µ
                ‚Üì
2. Supabase   ‚Üí –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–∫–µ–Ω
                ‚Üì
3. Supabase   ‚Üí –î–µ–ª–∞–µ—Ç redirect –Ω–∞ bakery-app://auth-callback
                ‚Üì
4. Android    ‚Üí –í–∏–¥–∏—Ç —Å—Ö–µ–º—É bakery-app:// 
                ‚Üì
5. Android    ‚Üí –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–ë—É–ª–æ—á–∫–∏ –ü–∞–≤–ª–æ–≤–∞"
                ‚Üì
6. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Üí –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç Deep Link –≤ _layout.tsx
                ‚Üì
7. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Üí –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–µ—Å—Å–∏—é (startAutoRefresh)
                ‚Üì
8. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Üí –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é
                ‚Üì
9. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω! üéâ
```

---

## üìù –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –∫–æ–¥–µ

### app.json
```json
{
  "expo": {
    "scheme": "bakery-app",
    "android": {
      "intentFilters": [
        {
          "action": "VIEW",
          "autoVerify": true,
          "data": [
            {
              "scheme": "bakery-app",
              "host": "auth-callback"
            }
          ],
          "category": ["BROWSABLE", "DEFAULT"]
        }
      ]
    }
  }
}
```

### app/_layout.tsx
```typescript
// –û–±—Ä–∞–±–æ—Ç–∫–∞ Deep Links
useEffect(() => {
  const handleDeepLink = async (event: { url: string }) => {
    if (event.url.includes('auth-callback')) {
      await supabase.auth.startAutoRefresh();
      router.replace('/(tabs)');
    }
  };

  const subscription = Linking.addEventListener('url', handleDeepLink);
  Linking.getInitialURL().then((url) => {
    if (url) handleDeepLink({ url });
  });

  return () => subscription.remove();
}, []);
```

### src/context/AuthContext.tsx
```typescript
const signUp = async (email: string, password: string, fullName?: string, phone?: string) => {
  const { data, error } = await supabase.auth.signUp({ 
    email: email.trim().toLowerCase(), 
    password,
    options: {
      data: { full_name: fullName, phone: phone },
      emailRedirectTo: 'bakery-app://auth-callback', // ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–æ!
    }
  });
  // ...
};
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ!

### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:
1. –°–æ–±–µ—Ä–∏—Ç–µ APK —Å –Ω–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω
3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å —Å —Ä–µ–∞–ª—å–Ω—ã–º email
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ
5. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –≤ –ø–∏—Å—å–º–µ

### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Expo Go:
Deep Links –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ Expo Go. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ development build –∏–ª–∏ production APK.

---

## üé® Email —à–∞–±–ª–æ–Ω

–ö—Ä–∞—Å–∏–≤–æ–µ –ø–∏—Å—å–º–æ —Å:
- ‚úÖ –õ–æ–≥–æ—Ç–∏–ø–æ–º üç∞
- ‚úÖ –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–º –¥–∏–∑–∞–π–Ω–æ–º
- ‚úÖ –ë–æ–ª—å—à–æ–π –∫–Ω–æ–ø–∫–æ–π –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- ‚úÖ –°–ø–∏—Å–∫–æ–º –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–π –≤—ë—Ä—Å—Ç–∫–æ–π
- ‚úÖ –ë—Ä–µ–Ω–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º "–ë—É–ª–æ—á–∫–∏ –ü–∞–≤–ª–æ–≤–∞"

---

## üìã –ß–µ–∫–ª–∏—Å—Ç

- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ö–µ–º–∞ –≤ app.json
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã intentFilters –¥–ª—è Android
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ Deep Links –≤ _layout.tsx
- [x] –î–æ–±–∞–≤–ª–µ–Ω emailRedirectTo –≤ AuthContext
- [x] –°–æ–∑–¥–∞–Ω HTML —à–∞–±–ª–æ–Ω –¥–ª—è email
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã Redirect URLs –≤ Supabase
- [ ] –í–∫–ª—é—á–µ–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email –≤ Supabase
- [ ] –û–±–Ω–æ–≤–ª—ë–Ω email —à–∞–±–ª–æ–Ω –≤ Supabase
- [ ] –ü–µ—Ä–µ—Å–æ–±—Ä–∞–Ω APK
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

---

**–í—Ä–µ–º—è:** 15 –º–∏–Ω—É—Ç (–∫–æ–¥) + 5 –º–∏–Ω—É—Ç (Supabase)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ö–æ–¥ –≥–æ—Ç–æ–≤, –æ—Å—Ç–∞–ª–æ—Å—å –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Supabase  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Supabase –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤—ã—à–µ
